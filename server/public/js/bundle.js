(()=>{document.getElementById("driverBtn").addEventListener("click",()=>{S("driverBtn");let e=document.getElementById("yearSelect").value;$("drivers",e)});document.getElementById("constructorBtn").addEventListener("click",()=>{S("constructorBtn");let e=document.getElementById("yearSelect").value;$("constructors",e)});document.getElementById("racesBtn").addEventListener("click",()=>{S("racesBtn");let e=document.getElementById("yearSelect").value;w(e,"races")});document.getElementById("sprintsBtn").addEventListener("click",()=>{S("sprintsBtn");let e=document.getElementById("yearSelect").value;w(e,"sprints")});document.getElementById("qualifyingBtn").addEventListener("click",()=>{S("qualifyingBtn");let e=document.getElementById("yearSelect").value;q(e)});document.getElementById("yearSelect").addEventListener("change",()=>{let e=document.querySelector("button.active")?.id,c=document.getElementById("yearSelect").value;e==="driverBtn"?$("drivers",c):e==="constructorBtn"?$("constructors",c):e==="racesBtn"?w(c,"races"):e==="sprintsBtn"?w(c,"sprints"):e==="qualifyingBtn"&&q(c)});function S(e){document.querySelectorAll("button").forEach(c=>c.classList.remove("active")),document.getElementById(e).classList.add("active"),document.getElementById("driversContent").style.display="none",document.getElementById("constructorsContent").style.display="none",document.getElementById("racesContent").style.display="none",document.getElementById("sprintsContent").style.display="none",document.getElementById("qualifyingContent").style.display="none",e==="driverBtn"?document.getElementById("driversContent").style.display="block":e==="constructorBtn"?document.getElementById("constructorsContent").style.display="block":e==="racesBtn"?document.getElementById("racesContent").style.display="block":e==="sprintsBtn"?document.getElementById("sprintsContent").style.display="block":e==="qualifyingBtn"&&(document.getElementById("qualifyingContent").style.display="block")}function q(e){let c=document.getElementById("qualifyingList");c.innerHTML="",document.getElementById("qualifyingResults").style.display="none",document.getElementById("qualifyingResultsTable").innerHTML="";let r=document.getElementById("qualifyingSelect");r.innerHTML="",r.classList.add("mobileSelect"),D(e).then(s=>{if(s&&s.length>0){s.forEach((l,n)=>{let t=document.createElement("button");t.textContent=l.raceName,t.classList.add("race-btn"),setTimeout(()=>{t.classList.add("animate-in")},n*25),t.addEventListener("click",()=>{document.querySelectorAll(".race-btn.active").forEach(a=>a.classList.remove("active")),t.classList.add("active"),F(l)}),c.appendChild(t)});let i=document.createElement("option");i.textContent="Select a race...",i.disabled=!0,i.selected=!0,r.appendChild(i),s.forEach(l=>{let n=document.createElement("option");n.value=l.round,n.textContent=l.raceName,r.appendChild(n)}),r.addEventListener("change",()=>{let l=r.value,n=s.find(t=>t.round===l);F(n)})}else c.textContent="No qualifying data available."}).catch(s=>console.error("Error fetching qualifying list:",s))}function F(e){let r=`/api/ergast/f1/${document.getElementById("yearSelect").value}/${e.round}/qualifying/?limit=1000`;fetch(r).then(s=>s.json()).then(s=>{let i=s.MRData.RaceTable.Races[0];document.getElementById("qualifyingResults").style.display="block";let n=document.querySelector("#qualifyingResults table").querySelector("thead");n.innerHTML="";let t=document.createElement("tr"),a=document.createElement("th");a.colSpan=6,a.innerHTML=`
                    <div class="race-info-row">
                        <span class="race-title">${i.raceName}</span>
                        <span class="race-location">${i.Circuit.Location.locality}, ${i.Circuit.Location.country}</span>
                        <span class="race-date">${i.date}</span>
                    </div>
                `,t.appendChild(a),n.appendChild(t);let o=document.createElement("tr"),p=document.createElement("th");p.id="te-position",p.textContent="Position",o.appendChild(p);let d=document.createElement("th");d.id="te-driver",d.textContent="Driver",o.appendChild(d);let y=document.createElement("th");y.id="te-constructor",y.textContent="Constructor",o.appendChild(y);let C=document.createElement("th");C.id="te-q1",C.textContent="Q1",o.appendChild(C);let E=document.createElement("th");E.id="te-q2",E.textContent="Q2",o.appendChild(E);let u=document.createElement("th");u.id="te-q3",u.textContent="Q3",o.appendChild(u),n.appendChild(o);let L=document.getElementById("qualifyingResultsTable");L.innerHTML="",i.QualifyingResults.forEach(h=>{let v=L.insertRow();v.insertCell().textContent=h.position,v.insertCell().textContent=`${h.Driver.givenName} ${h.Driver.familyName}`,v.insertCell().textContent=h.Constructor.name,v.insertCell().textContent=h.Q1||"",v.insertCell().textContent=h.Q2||"",v.insertCell().textContent=h.Q3||""});let g=document.getElementById("qualifyingResults");g.classList.remove("table-animate-in"),g.offsetWidth,g.classList.add("table-animate-in"),A()}).catch(s=>console.error("Error fetching full qualifying results:",s))}function N(e){let c=`/api/ergast/f1/${e}/sprint/?limit=1000`;return fetch(c).then(r=>r.json()).then(r=>r.MRData.RaceTable.Races)}function D(e){let c=`/api/ergast/f1/${e}/races/?limit=1000`;return fetch(c).then(r=>r.json()).then(r=>r.MRData.RaceTable.Races)}function w(e,c){if(c==="races"){let r=document.getElementById("raceList");r.innerHTML="",document.getElementById("raceResults").style.display="none",document.getElementById("raceResultsTable").innerHTML="";let s=document.getElementById("raceSelect");s.innerHTML="",s.classList.add("mobileSelect"),D(e).then(i=>{if(i&&i.length>0){i.forEach((n,t)=>{let a=document.createElement("button");a.textContent=n.raceName,a.classList.add("race-btn"),setTimeout(()=>{a.classList.add("animate-in")},t*25),a.addEventListener("click",()=>{document.querySelectorAll(".race-btn.active").forEach(o=>o.classList.remove("active")),a.classList.add("active"),R(n,"races")}),r.appendChild(a)});let l=document.createElement("option");l.textContent="Select a race...",l.disabled=!0,l.selected=!0,s.appendChild(l),i.forEach(n=>{let t=document.createElement("option");t.value=n.round,t.textContent=n.raceName,s.appendChild(t)}),s.addEventListener("change",()=>{let n=s.value,t=i.find(a=>a.round===n);R(t,"races")})}else r.textContent="No race data available."}).catch(i=>console.error("Error fetching race list:",i))}else if(c==="sprints"){let r=document.getElementById("sprintList");r.innerHTML="",document.getElementById("sprintResults").style.display="none",document.getElementById("sprintResultsTable").innerHTML="";let s=document.getElementById("sprintSelect");s.innerHTML="",s.classList.add("mobileSelect"),N(e).then(i=>{if(i&&i.length>0){i.forEach((n,t)=>{let a=document.createElement("button");a.textContent=n.raceName,a.classList.add("race-btn"),setTimeout(()=>{a.classList.add("animate-in")},t*25),a.addEventListener("click",()=>{document.querySelectorAll(".race-btn.active").forEach(o=>o.classList.remove("active")),a.classList.add("active"),R(n,"sprints")}),r.appendChild(a)});let l=document.createElement("option");l.textContent="Select a sprint...",l.disabled=!0,l.selected=!0,s.appendChild(l),i.forEach(n=>{let t=document.createElement("option");t.value=n.round,t.textContent=n.raceName,s.appendChild(t)}),s.addEventListener("change",()=>{let n=s.value,t=i.find(a=>a.round===n);R(t,"sprints")})}else r.textContent="No sprint data available (Sprints were first introduced in 2021)"}).catch(i=>console.error("Error fetching sprint list:",i))}}function R(e,c="races"){let r=document.getElementById("yearSelect").value,s=c==="races"?`/api/ergast/f1/${r}/${e.round}/results/?limit=1000`:`/api/ergast/f1/${r}/${e.round}/sprint/?limit=1000`;fetch(s).then(i=>i.json()).then(i=>{let l=i.MRData.RaceTable.Races[0],n=1/0;if(c==="races"?l.Results.forEach(t=>{if(t.FastestLap&&t.FastestLap.Time&&t.FastestLap.Time.time){let o=t.FastestLap.Time.time.split(":"),p=parseFloat(o[0])*60+parseFloat(o[1]);p<n&&(n=p)}}):l.SprintResults.forEach(t=>{if(t.FastestLap&&t.FastestLap.Time&&t.FastestLap.Time.time){let o=t.FastestLap.Time.time.split(":"),p=parseFloat(o[0])*60+parseFloat(o[1]);p<n&&(n=p)}}),c==="races"){document.getElementById("raceResults").style.display="block";let a=document.querySelector("#raceResults table").querySelector("thead");a.innerHTML="";let o=document.createElement("tr");o.classList.add("info-row");let p=document.createElement("th");p.colSpan=7,p.innerHTML=`
                    <div class="race-info-row">
                        <span class="race-title">${l.raceName}</span>
                        <span class="race-location">${l.Circuit.Location.locality}, ${l.Circuit.Location.country}</span>
                        <span class="race-date">${l.date}</span>
                    </div>
                `,o.appendChild(p),a.appendChild(o);let d=document.createElement("tr"),y=document.createElement("th");y.id="th-position",y.textContent="Position",d.appendChild(y);let C=document.createElement("th");C.id="th-driver",C.textContent="Driver",d.appendChild(C);let E=document.createElement("th");E.id="th-constructor",E.textContent="Constructor",d.appendChild(E);let u=document.createElement("th");u.id="th-points",u.textContent="Points",d.appendChild(u);let L=document.createElement("th");L.id="th-time",L.textContent="Time",d.appendChild(L);let g=document.createElement("th");g.id="th-fastestlap",g.textContent="Fastest Lap",d.appendChild(g);let h=document.createElement("th");h.id="th-averagespeed",h.textContent="Average Speed (kph)",d.appendChild(h),a.appendChild(d);let v=document.getElementById("raceResultsTable");v.innerHTML="",l.Results.forEach(m=>{let B=v.insertRow(),x=m.positionText==="R"?"DNF":m.positionText;B.insertCell().textContent=x,B.insertCell().textContent=`${m.Driver.givenName} ${m.Driver.familyName}`,B.insertCell().textContent=m.Constructor.name,B.insertCell().textContent=m.points,B.insertCell().textContent=m.Time?m.Time.time:m.status;let T=B.insertCell();if(m.FastestLap&&m.FastestLap.Time&&m.FastestLap.Time.time){let b=m.FastestLap.Time.time;T.textContent=b;let I=b.split(":"),M=parseFloat(I[0])*60+parseFloat(I[1]);Math.abs(M-n)<.001&&(T.style.color="#2BDE73")}else T.textContent="N/A";B.insertCell().textContent=m.FastestLap&&m.FastestLap.AverageSpeed?m.FastestLap.AverageSpeed.speed:"N/A"});let f=document.getElementById("raceResults");f.classList.remove("table-animate-in"),f.offsetWidth,f.classList.add("table-animate-in"),k()}else{document.getElementById("sprintResults").style.display="block";let a=document.querySelector("#sprintResults table").querySelector("thead");a.innerHTML="";let o=document.createElement("tr"),p=document.createElement("th");p.colSpan=6,p.innerHTML=`
                    <div class="race-info-row">
                        <span class="race-title">${l.raceName}</span>
                        <span class="race-location">${l.Circuit.Location.locality}, ${l.Circuit.Location.country}</span>
                        <span class="race-date">${l.date}</span>
                    </div>
                `,o.appendChild(p),a.appendChild(o);let d=document.createElement("tr"),y=document.createElement("th");y.id="tw-position",y.textContent="Position",d.appendChild(y);let C=document.createElement("th");C.id="tw-driver",C.textContent="Driver",d.appendChild(C);let E=document.createElement("th");E.id="tw-constructor",E.textContent="Constructor",d.appendChild(E);let u=document.createElement("th");u.id="tw-points",u.textContent="Points",d.appendChild(u);let L=document.createElement("th");L.id="tw-time",L.textContent="Time",d.appendChild(L);let g=document.createElement("th");g.id="tw-fastestlap",g.textContent="Fastest Lap",d.appendChild(g),a.appendChild(d);let h=document.getElementById("sprintResultsTable");h.innerHTML="",l.SprintResults.forEach(f=>{let m=h.insertRow(),B=f.positionText==="R"?"DNF":f.positionText;m.insertCell().textContent=B,m.insertCell().textContent=`${f.Driver.givenName} ${f.Driver.familyName}`,m.insertCell().textContent=f.Constructor.name,m.insertCell().textContent=f.points,m.insertCell().textContent=f.Time?f.Time.time:f.status;let x=m.insertCell();if(f.FastestLap&&f.FastestLap.Time&&f.FastestLap.Time.time){let T=f.FastestLap.Time.time;x.textContent=T;let b=T.split(":"),I=parseFloat(b[0])*60+parseFloat(b[1]);Math.abs(I-n)<.001&&(x.style.color="#2BDE73")}else x.textContent="N/A"});let v=document.getElementById("sprintResults");v.classList.remove("table-animate-in"),v.offsetWidth,v.classList.add("table-animate-in"),H()}}).catch(i=>console.error("Error fetching full race/sprint results:",i))}function $(e,c){let r=e==="drivers"?`/api/ergast/f1/${c}/driverstandings/`:`/api/ergast/f1/${c}/constructorstandings/`;fetch(r).then(s=>s.json()).then(s=>{console.log(s);let i=s.MRData.StandingsTable.StandingsLists[0],l=document.getElementById(e==="drivers"?"driversTable":"constructorsTable");l.innerHTML="",i?(e==="drivers"?i.DriverStandings:i.ConstructorStandings).forEach((t,a)=>{let o=l.insertRow();o.insertCell().textContent=a+1,e==="drivers"?(o.insertCell().textContent=`${t.Driver.givenName} ${t.Driver.familyName}`,o.insertCell().textContent=t.Constructors[0].name):(o.insertCell().textContent=t.Constructor.name,o.insertCell().textContent=t.Constructor.nationality),o.insertCell().textContent=t.points,o.insertCell().textContent=t.wins||"N/A"}):console.log(`No ${e} standings data available.`)}).catch(s=>console.error(`Error fetching ${e} standings:`,s)),P(e,c)}function P(e,c){let r=e==="drivers"?`/api/ergast/f1/${c}/driverstandings/`:`/api/ergast/f1/${c}/constructorstandings/`;fetch(r).then(s=>s.json()).then(s=>{let i=s.MRData.StandingsTable.StandingsLists[0],l=e==="drivers"?i.DriverStandings:i.ConstructorStandings,n;window.innerWidth<=768?c<1970?n=1:c<2010?n=.6:c<2016?n=.4:n=.37:c<1970?n=8:c<2010?n=6:n=2;let t=e==="drivers"?"driversGraph":"constructorsGraph",a=document.getElementById(t);a.innerHTML="",a.style.display="block",l.forEach(o=>{let p=parseFloat(o.points),d="",y="";e==="drivers"?(d=o.Driver.code?o.Driver.code:o.Driver.familyName.substr(0,3).toUpperCase(),y=o.Constructors[0].constructorId):(d=o.Constructor.name.substr(0,3).toUpperCase(),y=o.Constructor.constructorId||o.Constructor.name.toLowerCase().replace(/\s+/g,"_"));let C=document.createElement("div");C.classList.add("graph-row");let E=document.createElement("div");E.classList.add("graph-code"),E.textContent=d,C.appendChild(E);let u=document.createElement("div");u.classList.add("graph-bar");let L=p*n;u.style.width="0px";let g=getComputedStyle(document.documentElement).getPropertyValue(`--${y}`).trim();g||(g="#ffffff"),u.style.backgroundColor=g,u.style.boxShadow=`0 0 5px ${g}`,C.appendChild(u),setTimeout(()=>{u.style.width=`${L}px`},50);let h=document.createElement("span");h.classList.add("graph-points"),h.textContent=p,C.appendChild(h),a.appendChild(C)})}).catch(s=>console.error(`Error fetching ${e} standings for graph:`,s))}function k(){window.innerWidth<=768?(document.getElementById("th-position").innerText="Pos",document.getElementById("th-constructor").innerText="Team",document.getElementById("th-points").innerText="Pts",document.getElementById("th-averagespeed").innerText="Avg Spd"):(document.getElementById("th-position").innerText="Position",document.getElementById("th-points").innerText="Points",document.getElementById("th-averagespeed").innerText="Average Speed (kph)")}function H(){window.innerWidth<=768?(document.getElementById("tw-position").innerText="Pos",document.getElementById("tw-constructor").innerText="Team",document.getElementById("tw-points").innerText="Pts"):(document.getElementById("tw-position").innerText="Position",document.getElementById("tw-points").innerText="Points")}function A(){window.innerWidth<=768?(document.getElementById("te-position").innerText="Pos",document.getElementById("te-constructor").innerText="Team"):document.getElementById("te-position").innerText="Position"}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("intro"),c=document.querySelector(".loading-bar"),r=document.querySelector(".car-svg");c.style.animationPlayState="running",r.style.animationPlayState="running",setTimeout(()=>{e.classList.add("hidden")},1e3)});})();
